// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(k,g,q,w,c,b,u,p){k=k([b,u],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(b,e){g.mixin(this,e);this.initialize(b,e)},getTitle:function(b){var e;this.info&&(e=this.titleHasRelatedFields?"":this._getPopupValues(b,null,!0).title);return e||
""},getContent:function(b){return this.info?(new p({template:this,graphic:b,chartTheme:this.chartTheme},w.create("div"))).domNode:""}});q("extend-esri")&&g.setObject("dijit.PopupTemplate",k,c);return k})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./promiseList ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./support/expressionUtils ./layers/support/attributeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),
function(k,g,q,w,c,b,u,p,n,e,t,D,v,A,B,C,F,a,f,r,z){k=k(null,{declaredClass:"esri.PopupInfo",_reExprField:/^\s*expression\//i,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",initialize:function(d,l){if(d){g.mixin(this,l);this.info=d;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var a=this._fieldLabels={},x=this._fieldsMap={};this.info.fieldInfos&&q.forEach(this.info.fieldInfos,function(m){var h=m.fieldName.toLowerCase(),
d=this._isExpressionField(h)?this.getExpressionInfo(h):null;a[h]=d?d.title:m.label;x[h]=m},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return w.fromJson(w.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(d){var l;q.some(this.info&&this.info.fieldInfos,function(a){a.fieldName===d&&(l=a);return!!l});return l},getExpressionInfo:function(d){if(this._isExpressionField(d)){d=d.replace(this._reExprField,
"");d=d.toLowerCase();var l;q.some(this.info.expressionInfos,function(a){a.name.toLowerCase()===d&&(l=a);return!!l});return l}},hasGeometryOperations:function(){return q.some(this.info.expressionInfos,function(d){return f.hasGeometryOperations(d.expression)})},getComponents:function(d){var l=this.info,a={};l.fieldInfos&&(l=q.filter(l.fieldInfos,function(d){return-1!==d.fieldName.indexOf(this._relatedFieldPrefix)},this))&&0<l.length&&(a.relatedInfo=this._getRelatedRecords({graphic:d,fieldsInfo:l}));
this._needFullResolutionFeature(d)&&(a.fullResolutionFeature=this._getFullResolutionFeature(d));return A(a).then(g.hitch(this,function(l){return this._getPopupValues(d,l.fullResolutionFeature)}))},getAttachments:function(d){var l=d.getSourceLayer();d=d.attributes;if(this.info.showAttachments&&l&&l.hasAttachments&&l.objectIdField&&(d=d&&d[l.objectIdField]))return l.queryAttachmentInfos(d)},_needFullResolutionFeature:function(d){return(d=d.getSourceLayer())?"esriGeometryPoint"!==d.geometryType&&"function"===
typeof d.getMaxAllowableOffset&&0<d.getMaxAllowableOffset()&&this.hasGeometryOperations():!1},_getFullResolutionFeature:function(d){var l=d.getSourceLayer(),a=l.objectIdField;d=(d=d.attributes)&&a&&d[a];if(null==d)return null;var x=new B;x.objectIds=[d];x.maxAllowableOffset=0;x.outFields=[a];return l.queryFeatures(x).then(function(m){return m.features&&m.features[0]})},_isExpressionField:function(d){return this._reExprField.test(d)},_compileExpressions:function(d){var a={};q.forEach(d,function(d){var l=
d.returnType&&d.returnType.toLowerCase();a[d.name]=r.createAttributeCache({valueExpression:d.expression},"number"!==l)});return a},_fetchAttributes:function(d,a){var l=g.clone(d.attributes)||{},x=a&&a.geometry,m=this._exprPrefix,h=this._exprCache;q.forEach(this.info.expressionInfos,function(a){var y=m+a.name;a=(a=h[a.name])?d._getDataValue(a.attributeInfo,a,f,null,x):null;"string"===typeof a&&(a=e.encode(a));l[y]=a});return l},_getPopupValues:function(d,a,y){var l=this.info,m=d.getSourceLayer(),h=
this._fetchAttributes(d,a),E=g.clone(h);a=l.fieldInfos;var f="",b="",B,e,r,c,v,z=m&&m._getDateOpts&&m._getDateOpts().properties,z=z&&z.slice(0),p={dateFormat:{properties:z,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(c in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(c)){var n=this._relatedInfo[c],w=this._relatedLayersInfo[c];n&&(q.forEach(n.relatedFeatures,function(m){for(v in m.attributes)if(m.attributes.hasOwnProperty(v)&&"esriRelCardinalityOneToOne"===
w.relation.cardinality){var d=this._toRelatedFieldName([w.relation.id,v]);h[d]=E[d]=m.attributes[v]}},this),q.forEach(n.relatedStatsFeatures,function(m){for(v in m.attributes)if(m.attributes.hasOwnProperty(v)){var d=this._toRelatedFieldName([w.relation.id,v]);h[d]=E[d]=m.attributes[v]}},this))}a&&q.forEach(a,function(h){e=h.fieldName;var d=this._getLayerFieldInfo(m,e);d&&(e=h.fieldName=d.name);E[e]=this._formatValue(E[e],e,p);z&&h.format&&h.format.dateFormat&&(h=q.indexOf(z,e),-1<h&&z.splice(h,1))},
this);if(m){c=m.types;var u=(n=m.typeIdField)&&h[n];for(e in h)if(h.hasOwnProperty(e)&&-1===e.indexOf(this._relatedFieldPrefix)&&(r=h[e],t.isDefined(r))){var C=this._getDomainName(m,d,c,u,e,r);t.isDefined(C)?E[e]=C:e===n&&(C=this._getTypeName(m,d,r),t.isDefined(C)&&(E[e]=C))}}l.title&&(f=this._processFieldsInLinks(this._fixTokens(l.title,m),h),f=g.trim(t.substitute(E,f,p)||""));if(y)return{title:f};l.description&&(b=this._processFieldsInLinks(this._fixTokens(l.description,m),h),b=g.trim(t.substitute(E,
b,p)||""));a&&(B=[],q.forEach(a,function(h){(e=h.fieldName)&&h.visible&&B.push([this._fieldLabels[e.toLowerCase()]||e,t.substitute(E,"${"+e+"}",p)||""])},this));var k,A;l.mediaInfos&&(k=[],q.forEach(l.mediaInfos,function(d){A=0;r=d.value;switch(d.type){case "image":var a=r.sourceURL,a=a&&g.trim(t.substitute(h,this._fixTokens(a,m)));A=!!a;break;case "piechart":case "linechart":case "columnchart":case "barchart":var l,a=r.normalizeField;r.fields=q.map(r.fields,function(h){return(l=this._getLayerFieldInfo(m,
h))?l.name:h},this);a&&(l=this._getLayerFieldInfo(m,a),r.normalizeField=l?l.name:a);A=q.some(r.fields,function(m){return t.isDefined(h[m])||-1!==m.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(A){d=g.clone(d);r=d.value;var a=d.title?this._processFieldsInLinks(this._fixTokens(d.title,m),h):"",x=d.caption?this._processFieldsInLinks(this._fixTokens(d.caption,m),h):"";d.title=a?g.trim(t.substitute(E,a,p)||""):"";d.caption=x?g.trim(t.substitute(E,x,p)||""):"";if("image"===
d.type)r.sourceURL=t.substitute(h,this._fixTokens(r.sourceURL,m)),r.linkURL&&(r.linkURL=g.trim(t.substitute(h,this._fixTokens(r.linkURL,m))||""));else{var f,y;q.forEach(r.fields,function(m,d){if(-1!==m.indexOf(this._relatedFieldPrefix))y=this._getRelatedChartInfos(m,r,h,p),y instanceof Array?r.fields=y:r.fields[d]=y;else{var a=h[m],a=void 0===a?null:a;f=h[r.normalizeField]||0;a&&f&&(a/=f);r.fields[d]={y:a,tooltip:(this._fieldLabels[m.toLowerCase()]||m)+":\x3cbr/\x3e"+this._formatValue(a,m,p,!!f)}}},
this)}k.push(d)}},this));return{title:f,description:b,hasDescription:!!l.description,fields:B&&B.length?B:null,mediaInfos:k&&k.length?k:null,formatted:E,editSummary:m&&m.getEditSummary?m.getEditSummary(d):""}},_getRelatedChartInfos:function(d,a,f,x){var m,h,l,y,b,r;m=[];r=this._fromRelatedFieldName(d);b=r[0];h=this._relatedInfo[b];b=this._relatedLayersInfo[b];h&&q.forEach(h.relatedFeatures,function(h){h=h.attributes;var b,E;for(E in h)if(h.hasOwnProperty(E)&&E===r[1]){b={};y=h[E];a.normalizeField&&
(l=-1!==a.normalizeField.indexOf(this._relatedFieldPrefix)?h[this._fromRelatedFieldName(a.normalizeField)[1]]:f[a.normalizeField]);y&&l&&(y/=l);if(a.tooltipField)if(-1!==a.tooltipField.indexOf(this._relatedFieldPrefix)){var e=this._fromRelatedFieldName(a.tooltipField)[1],B=t.isDefined(h[e])?this._formatValue(h[e],a.tooltipField,x,!!l):e;b.tooltip=B+":\x3cbr/\x3e"+this._formatValue(y,e,x,!!l)}else b.tooltip=(this._fieldLabels[d.toLowerCase()]||d)+":\x3cbr/\x3e"+this._formatValue(y,a.tooltipField,x,
!!l);else b.tooltip=y;b.y=y;m.push(b)}},this);return"esriRelCardinalityOneToMany"===b.relation.cardinality||"esriRelCardinalityManyToMany"===b.relation.cardinality?m:m[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",
shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_reEmptyHref:/^href\s*=\s*"\s*"$/i,_reEmptyHrefApos:/^href\s*=\s*'\s*'$/i,_fixTokens:function(d,a){var l=this;return d.replace(/(\{([^\{\r\n]+)\})/g,function(d,m,h){d=
l._getLayerFieldInfo(a,h);return"$"+(d?"{"+d.name+"}":m)})},_encodeAttributes:function(d){d=g.clone(d)||{};var a,y;for(a in d)(y=d[a])&&"string"===typeof y&&(y=encodeURIComponent(y).replace(/\'/g,"\x26apos;"),d[a]=y);return d},_processFieldsInLinks:function(d,a){var l=this._encodeAttributes(a);a=g.hitch(this,this._addValuesToHref,a,l);d&&(d=d.replace(this._reHref,a).replace(this._reHrefApos,a));return d},_addValuesToHref:function(a,l,f,x){x=x&&g.trim(x);f=t.substitute(x&&0===x.indexOf("${")?a:l,f);
this._reEmptyHref.test(f)?f='href\x3d"about:blank"':this._reEmptyHrefApos.test(f)&&(f="href\x3d'about:blank'");return f},_getLayerFieldInfo:function(a,l){return a&&a.getField?a.getField(l):null},_formatValue:function(a,l,f,x){var m=this._fieldsMap[l.toLowerCase()],h=m&&m.format;l=-1!==q.indexOf(f.dateFormat.properties,l);var d="number"===typeof a&&!l&&(!h||!h.dateFormat);if(!t.isDefined(a)||!m||!t.isDefined(h))return d?this._forceLTR(a):a;var b="",m=[],y=h.hasOwnProperty("places")||h.hasOwnProperty("digitSeparator"),
r=h.hasOwnProperty("digitSeparator")?h.digitSeparator:!0;if(y&&!l)b="NumberFormat",m.push("places: "+(t.isDefined(h.places)&&(!x||0<h.places)?Number(h.places):"Infinity")),m.length&&(b+="("+m.join(",")+")");else if(h.dateFormat)b="DateFormat"+this._insertOffset(this._dateFormats[h.dateFormat]||this._dateFormats.shortDateShortTime);else return d?this._forceLTR(a):a;var e=this._applyFormatting(a,b,f);y&&-1<a.constructor.toString().indexOf("Array")&&(e="",q.forEach(a,g.hitch(this,function(h,a){a&&(e+=
" ");e+=this._applyFormatting(h,b,f)})));y&&!r&&z.group&&(e=e.replace(new RegExp("\\"+z.group,"g"),""));l&&(e='\x3cspan class\x3d"esriDateValue"\x3e'+e+"\x3c/span\x3e");return d?this._forceLTR(e):e},_applyFormatting:function(a,l,f){return t.substitute({myKey:a},"${myKey:"+l+"}",f)||""},_forceLTR:function(a){var d=p("ie");return d&&10>=d?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=t.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+
")"):a);return a},_getDomainName:function(a,l,f,x,m,h){return(a=a.getDomain&&a.getDomain(m,{feature:l}))&&a.codedValues?a.getName(h):null},_getTypeName:function(a,l,f){return(a=a.getType&&a.getType(l))&&a.name},_getRelatedRecords:function(a){var d=a.graphic,f;this._relatedLayersInfoPromise||(this._relatedLayersInfoPromise=this._getRelatedLayersInfo(a).then(g.hitch(this,function(a){for(f in a)a.hasOwnProperty(f)&&a[f]&&(this._relatedLayersInfo[f].relatedLayerInfo=a[f])})));return this._relatedLayersInfoPromise.then(g.hitch(this,
function(){return this._queryRelatedLayers(d)})).then(g.hitch(this,function(a){this._setRelatedRecords(d,a);return a}))},_getRelatedLayersInfo:function(d){var l=d.fieldsInfo,f,x,m={};f=d.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});q.forEach(l,function(h){var m,d,l,x;m=this._fromRelatedFieldName(h.fieldName);d=m[0];m=m[1];d&&(!this._relatedLayersInfo[d]&&f&&f.relationships&&(q.some(f.relationships,function(a){if(a.id==d)return x=a,!0}),x&&(this._relatedLayersInfo[d]=
{relation:x,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(m),h.statisticType&&(l=new a,l.statisticType=h.statisticType,l.onStatisticField=m,l.outStatisticFieldName=m,this._relatedLayersInfo[d].outStatistics.push(l))))},this);for(x in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(x)&&this._relatedLayersInfo[x]&&(d=this._relatedLayersInfo[x].relation,d=f.url.replace(/[0-9]+$/,d.relatedTableId),this._relatedLayersInfo[x].relatedLayerUrl=
d,m[x]=v({url:d,content:{f:"json"},callbackParamName:"callback"}));return n(m)},_queryRelatedLayers:function(a){var d={},f;for(f in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(f)&&(d[f]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[f]}));return n(d)},_queryRelatedLayer:function(a){var d,f,x,m,h,b,e,r,c,v,z,p,t;d=a.graphic;f=d.getSourceLayer();x=f.url.match(/[0-9]+$/g)[0];z=a.relatedInfo;v=z.relatedLayerInfo;p=z.relatedLayerUrl;a=z.relation;q.some(v.relationships,
function(a){if(a.relatedTableId===parseInt(x,10))return m=a,!0},this);m&&(h=new B,q.some(v.fields,function(a){if(a.name===m.keyField)return r=-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),m.relationshipTableId&&m.keyFieldInRelationshipTable?(t=new u,this._queryRelatedRecords(d,m).then(g.hitch(this,function(a){var m;(m=a[d.attributes[f.objectIdField]])?(a=q.map(m.features,function(a){return a.attributes[v.objectIdField]},
this),z.outStatistics&&0<z.outStatistics.length&&v.supportsStatistics&&(c=new B,c.objectIds=a,c.outFields=h.outFields,c.outStatistics=z.outStatistics),c&&(b=new C(p),b.execute(c).then(g.hitch(this,function(a){var h=[];h.push(m);h.push(a);t.resolve(h)})))):t.resolve()}))):(e="string"===r?m.keyField+"\x3d'"+d.attributes[a.keyField]+"'":m.keyField+"\x3d"+d.attributes[a.keyField],h.where=e,h.outFields=z.relatedFields,z.outStatistics&&0<z.outStatistics.length&&v.supportsStatistics&&(c=new B,c.where=h.where,
c.outFields=h.outFields,c.outStatistics=z.outStatistics),b=new C(p),e=[],e.push(b.execute(h)),c&&e.push(b.execute(c))));return e?n(e):t?t.promise:void 0},_setRelatedRecords:function(a,l){this._relatedInfo=[];for(var d in l)l.hasOwnProperty(d)&&l[d]&&(a=l[d],this._relatedInfo[d]={},this._relatedInfo[d].relatedFeatures=a[0].features,t.isDefined(a[1])&&(this._relatedInfo[d].relatedStatsFeatures=a[1].features))},_handlerErrorResponse:function(a,l){a.reject(l)},_fromRelatedFieldName:function(a){var d=
[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),d=a.slice(1));return d},_toRelatedFieldName:function(a){var d="";a&&0<a.length&&(d=this._relatedFieldPrefix+a[0]+"/"+a[1]);return d},_queryRelatedRecords:function(a,l){var d=a.getSourceLayer(),f=new F;f.outFields=["*"];f.relationshipId=l.id;f.objectIds=[a.attributes[d.objectIdField]];return d.queryRelatedFeatures(f)}});b("extend-esri")&&(D.PopupInfo=D.PopupInfoTemplate=k);return k})},"dojox/html/entities":function(){define(["dojo/_base/lang"],
function(k){var g=k.getObject("dojox.html.entities",!0),q=function(c,b){var g,p;if(b._encCache&&b._encCache.regexp&&b._encCache.mapper&&b.length==b._encCache.length)g=b._encCache.mapper,p=b._encCache.regexp;else{g={};p=["["];var n;for(n=0;n<b.length;n++)g[b[n][0]]="\x26"+b[n][1]+";",p.push(b[n][0]);p.push("]");p=new RegExp(p.join(""),"g");b._encCache={mapper:g,regexp:p,length:b.length}}return c=c.replace(p,function(b){return g[b]})},w=function(c,b){var g,p;if(b._decCache&&b._decCache.regexp&&b._decCache.mapper&&
b.length==b._decCache.length)g=b._decCache.mapper,p=b._decCache.regexp;else{g={};p=["("];var n;for(n=0;n<b.length;n++){var e="\x26"+b[n][1]+";";n&&p.push("|");g[e]=b[n][0];p.push(e)}p.push(")");p=new RegExp(p.join(""),"g");b._decCache={mapper:g,regexp:p,length:b.length}}return c=c.replace(p,function(b){return g[b]})};g.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];g.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],
["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0",
"Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da",
"Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4",
"ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f",
"Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3",
"sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0",
"lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245",
"cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],
["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];g.encode=function(c,b){c&&(b?
c=q(c,b):(c=q(c,g.html),c=q(c,g.latin)));return c};g.decode=function(c,b){c&&(b?c=w(c,b):(c=w(c,g.html),c=w(c,g.latin)));return c};return g})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(k,g,q){var w=k.forEach;return function(c){function b(b,e){n[e]=b;D.progress([b,e]);0===--v&&D.resolve(n)}var k,p;c instanceof Array?p=c:c&&"object"===typeof c&&(k=c);var n,e=[];if(k){p=[];for(var t in k)Object.hasOwnProperty.call(k,t)&&(e.push(t),p.push(k[t]));n=
{}}else p&&(n=[]);if(!p||!p.length)return(new g).resolve(n);var D=new g;D.promise.always(function(){n=e=null});var v=p.length;w(p,function(c,B){k||e.push(B);q(c,function(c){D.isFulfilled()||b(c,e[B])},function(c){D.isFulfilled()||b(c,e[B])})});return D.promise}})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(k,g,q,w,c,b,u,p,n,e,t,D,v){var A=k(null,{url:null,query:null,requestOptions:null,pagination:null,pageSize:null,_fetchDfd:null,_startPage:null,_result:null,constructor:function(b){this._handleSuccess=g.hitch(this,this._handleSuccess);this._handleError=g.hitch(this,this._handleError);g.mixin(this,b);null==this.pagination&&(this.pagination=!1);null==this.pageSize&&(this.pageSize=1E3)},execute:function(){var b=new w(this._canceler);this._fetchDfd=b;this._result=null;this._sendRequest();return b.promise},
_canceler:function(b){var e=b._pendingRequest,c;b.isFulfilled()||!e||e.isFulfilled()||(e.cancel(),c=e.results&&e.results[1]);b._pendingRequest=null;return c},_sendRequest:function(b){var e=this.query;this.pagination&&(this._startPage=e.resultOffset=null==b?0:b,e.resultRecordCount=this.pageSize);this._fetchDfd._pendingRequest=p({url:this.url,content:e,handleAs:"pbf"===e.f?"arraybuffer":"json",callbackParamName:"callback"},this.requestOptions);this._fetchDfd._pendingRequest.then(this._handleSuccess).otherwise(this._handleError)},
_handleSuccess:function(b){this.pagination?(b.exceededTransferLimit&&this._sendRequest(this._startPage+this.pageSize),this._result?this._result.features=this._result.features.concat(b.features):this._result=b,this._fetchDfd.progress(b),b.exceededTransferLimit||this._fetchDfd.resolve(this._result)):(this._fetchDfd.progress(b),this._fetchDfd.resolve(b))},_handleError:function(b){this._fetchDfd.reject(b)}});k=k(D,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],
"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(b,e){this._handler=g.hitch(this,this._handler);this._relationshipQueryHandler=g.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=g.hitch(this,this._executeForIdsHandler);this._countHandler=g.hitch(this,this._countHandler);this._extentHandler=g.hitch(this,this._extentHandler);this.source=e&&e.source;this.gdbVersion=e&&e.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",
c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"rawExecute",c:2,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onRawExecuteComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(b,e,v,a,f){a=
f.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json"},b.toJson(a&&a[0])));var r=this._handler,z=this._errorHandler;this.source&&(a={source:this.source.toJson()},b.layer=c.toJson(a));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return p({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(a,l){r(a,l,e,v,f.dfd)},error:function(a){z(a,v,f.dfd)}},this.requestOptions)},rawExecute:function(b,e,v){e=e||{};b=this._encode(g.mixin({},this._url.query,{f:e.format||"json"},
b.toJson(v.assembly&&v.assembly[0])));this.source&&(b.layer=c.toJson({source:this.source.toJson()}));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return(new A({url:this._url.path+"/query",query:b,requestOptions:this.requestOptions,pagination:e.pagination,pageSize:e.pageSize})).execute().then(null,null,function(a){v.dfd.progress(a)}).then(g.hitch(this,function(a){this._successHandler([a],"onRawExecuteComplete",null,v.dfd)})).otherwise(g.hitch(this,function(a){this._errorHandler(a,null,v.dfd)}))},
executeRelationshipQuery:function(b,e,c){b=this._encode(g.mixin({},this._url.query,{f:"json"},b.toJson()));var a=this._relationshipQueryHandler,f=this._errorHandler;this.gdbVersion&&(b.gdbVersion=this.gdbVersion);var r=new w(n._dfdCanceller);r._pendingDfd=p({url:this._url.path+"/queryRelatedRecords",content:b,callbackParamName:"callback",load:function(b,d){a(b,d,e,c,r)},error:function(a){f(a,c,r)}},this.requestOptions);return r},executeForIds:function(b,e,v,a){var f=a.assembly;b=this._encode(g.mixin({},
this._url.query,{f:"json",returnIdsOnly:!0},b.toJson(f&&f[0])));var r=this._executeForIdsHandler,z=this._errorHandler;this.source&&(f={source:this.source.toJson()},b.layer=c.toJson(f));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return p({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(d,b){r(d,b,e,v,a.dfd)},error:function(d){z(d,v,a.dfd)}},this.requestOptions)},executeForCount:function(b,e,v,a){var f=a.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json",
returnIdsOnly:!0,returnCountOnly:!0},b.toJson(f&&f[0])));var r=this._countHandler,z=this._errorHandler;this.source&&(f={source:this.source.toJson()},b.layer=c.toJson(f));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return p({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(d,b){r(d,b,e,v,a.dfd)},error:function(d){z(d,v,a.dfd)}},this.requestOptions)},executeForExtent:function(b,e,v,a){var f=a.assembly;b=this._encode(g.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,
returnCountOnly:!0},b.toJson(f&&f[0])));var r=this._extentHandler,z=this._errorHandler;this.source&&(f={source:this.source.toJson()},b.layer=c.toJson(f));this.gdbVersion&&(b.gdbVersion=this.gdbVersion);return p({url:this._url.path+"/query",content:b,callbackParamName:"callback",load:function(d,b){r(d,b,e,v,a.dfd)},error:function(d){z(d,v,a.dfd)}},this.requestOptions)},_handler:function(b,e,c,a,f){try{var r=new v(b);this._successHandler([r],"onComplete",c,f)}catch(z){this._errorHandler(z,a,f)}},_relationshipQueryHandler:function(b,
e,c,a,f){try{var r=b.geometryType,z=b.spatialReference,d={};q.forEach(b.relatedRecordGroups,function(a){var b={};b.geometryType=r;b.spatialReference=z;b.features=a.relatedRecords;b=new v(b);if(null!=a.objectId)d[a.objectId]=b;else for(var f in a)a.hasOwnProperty(f)&&"relatedRecords"!==f&&(d[a[f]]=b)});this._successHandler([d],"onExecuteRelationshipQueryComplete",c,f)}catch(l){this._errorHandler(l,a,f)}},_executeForIdsHandler:function(b,e,c,a,f){try{this._successHandler([b.objectIds],"onExecuteForIdsComplete",
c,f)}catch(r){this._errorHandler(r,a,f)}},_countHandler:function(b,e,c,a,f){try{var r,v=b.features,d=b.objectIds;if(d)r=d.length;else{if(v)throw Error("Unable to perform query. Please check your parameters.");r=b.count}this._successHandler([r],"onExecuteForCountComplete",c,f)}catch(l){this._errorHandler(l,a,f)}},_extentHandler:function(b,c,v,a,f){try{b.extent&&(b.extent=new e(b.extent)),this._successHandler([b],"onExecuteForExtentComplete",v,f)}catch(r){this._errorHandler(r,a,f)}}});t._createWrappers(k);
b("extend-esri")&&g.setObject("tasks.QueryTask",k,u);return k})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(k,g,q,w,c,b,u,p){k=k(p,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(b,e){b&&g.isString(b)&&(this._url=u.urlToObject(this.url=b));e&&e.requestOptions&&(this.requestOptions=e.requestOptions);this.normalization=!0;
this._errorHandler=g.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var b=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));b&&b.path&&(b.path=b.path.replace(e,"https:"))},_encode:function(b,e,c){var p,v,t={},n,k;for(n in b)if("declaredClass"!==n&&(p=b[n],v=typeof p,null!==p&&void 0!==p&&"function"!==v))if(g.isArray(p))for(t[n]=[],k=p.length,v=0;v<k;v++)t[n][v]=this._encode(p[v]);else"object"===v?p.toJson&&(v=p.toJson(c&&c[n]),"esri.tasks.FeatureSet"===
p.declaredClass&&v.spatialReference&&(v.sr=v.spatialReference,delete v.spatialReference),t[n]=e?v:q.toJson(v)):t[n]=p;return t},_successHandler:function(c,e,p,g){e&&this[e].apply(this,c);p&&p.apply(null,c);g&&b._resDfd(g,c)},_errorHandler:function(b,e,c){this.onError(b);e&&e(b);c&&c.errback(b)},setNormalization:function(b){this.normalization=b},onError:function(){}});w("extend-esri")&&(c.Task=k);return k})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/Polygon ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(k,g,q,w,c,b,u,p,n,e,t,D){k=k(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b,e){if(b){g.mixin(this,b);var c=this.features=this.features||[],v=b.spatialReference,v=this.spatialReference=t.createInstance(p.simpleConstructor,v),n=t.getGeometryType(b.geometryType);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);b=t.supportsLazyUnquantization(this.geometryType);var a=t.unquantizeFunction(this.geometryType,this.transform),f=!!(e&&b&&a),r=n&&(f?n.accessorConstructor:
n.simpleConstructor);q.forEach(c,function(b,d){var l=t.createInstance(u.simpleConstructor),e=b.geometry;if(n&&e){var x=l.geometry=t.createInstance(r,f?null:e);x.setSpatialReference(e.spatialReference?t.createInstance(p.simpleConstructor,e.spatialReference):v);f&&x.setupLazyUnquantization(a,e)}l.symbol=b.symbol?D.fromJson(b.symbol):null;l.attributes=b.attributes;c[d]=l});f||this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(e){var c=
{};this.displayFieldName&&(c.displayFieldName=this.displayFieldName);this.fields&&(c.fields=this.fields);this.spatialReference?c.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(c.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(c.geometryType=t.getJsonType(this.features[0].geometry)),c.features=n._encodeGraphics(this.features,e));c.geometryType=c.geometryType||this.geometryType;c.exceededTransferLimit=
this.exceededTransferLimit;c.transform=this.transform;return b.fixJson(c)},_hydrate:function(){t.unquantize(this.features,this.geometryType,this.transform);this.transform=null},quantize:function(b){if(!this.geometryType)return this.transform=null,this;var e=b.translate[0],c=b.translate[1],v=b.scale[0],p=b.scale[1],a=this.features,f=function(a,b,d){var m,h,f,l,e,x,c=[];m=0;for(h=a.length;m<h;m++)if(f=a[m],0<m){if(x=b(f[0]),f=d(f[1]),x!==l||f!==e)c.push([x-l,f-e]),l=x,e=f}else l=b(f[0]),e=d(f[1]),c.push([l,
e]);return 0<c.length?c:null},r=function(a,b,d){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=d(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var h,m,l,e,x;l=a.rings||a.paths;x=[];h=0;for(m=l.length;h<m;h++)e=l[h],(e=f(e,b,d))&&x.push(e);return 0<x.length?(a.rings?a.rings=x:a.paths=x,a):null};if("esriGeometryMultipoint"===a)return function(a){var h;h=f(a.points,b,d);return 0<h.length?(a.points=h,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,
function(a){return Math.round((a-e)/v)},function(a){return Math.round((c-a)/p)}),g,d;g=0;for(d=a.length;g<d;g++)a[g].geometry&&(r(a[g].geometry)||a[g].setGeometry(null));this.transform=b;return this}});k.createGraphics=function(b){var e=b.geometryType,c=t.createInstance(p.simpleConstructor,b.spatialReference),g=t.getGeometryType(e).accessorConstructor,v=t.unquantizeFunction(e,b.transform);return q.map(b.features,function(a,b){b=t.createInstance(u.simpleConstructor);var f=a.geometry;if(f){var e=b.geometry=
t.createInstance(g);e.setSpatialReference(c);e.setupLazyUnquantization(v,f)}b.attributes=a.attributes;return b})};k.createPolygon=function(b,c,g){var p;b&&(p=t.createInstance(e.accessorConstructor),p.setSpatialReference(c),c=t.unquantizeFunction("esriGeometryPolygon",g),p.setupLazyUnquantization(c,b));return p};w("extend-esri")&&g.setObject("tasks.FeatureSet",k,c);return k})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],
function(k,g,q,w,c){k=k(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,orderByFields:null,toJson:function(){var b={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},c=this.objectIds,p=this.outFields,g=this.outSpatialReference,e=
this.orderByFields;c&&(b.objectIds=c.join(","));p&&(b.outFields=p.join(","));g&&(b.outSR=g.wkid||q.toJson(g.toJson()));e&&(b.orderByFields=e.join(","));b._ts=this._ts;return b}});w("extend-esri")&&g.setObject("tasks.RelationshipQuery",k,c);return k})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(k,g,q,w){k=k(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,
outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});q("extend-esri")&&g.setObject("tasks.StatisticDefinition",k,w);return k})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(k,g,q,w,c,b,u,p,n,e,t,D,v,A,B,C,F,a,f,r,z){var d=0,l=z.widgets.popup,y=z.widgets.templatePicker;g=g([r,B,C],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=w.mixin({},l)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'statusSection hidden' dojoAttachPoint\x3d'_status'\x3e\x3c/div\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this._showStatus(y.loading);this._contentDfd=this.template.getComponents(this.graphic).then(w.hitch(this,this._handleComponentsSuccess)).otherwise(w.hitch(this,this._handleComponentsError))},destroy:function(){this._contentDfd&&this._contentDfd.cancel();this._attachmentsDfd&&this._attachmentsDfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._contentDfd=this._attachmentsDfd=null;this.inherited(arguments)},
_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,m=a.length,h=this.domNode,d=this._prevMedia,f=this._nextMedia;if(1<m){var l=0,r=0;c.forEach(a,function(a){"image"===a.type?l++:-1!==a.type.indexOf("chart")&&r++});l&&(e.set(this._imageCount,"innerHTML",l),b.query(".summary .image",
h).removeClass("hidden"));r&&(e.set(this._chartCount,"innerHTML",r),b.query(".summary .chart",h).removeClass("hidden"))}else b.query(".summary",h).addClass("hidden"),t.add(d,"hidden"),t.add(f,"hidden");a=this._mediaPtr;0===a?t.add(d,"hidden"):t.remove(d,"hidden");a===m-1?t.add(f,"hidden"):t.remove(f,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],m=a.title,h=a.caption,f=b.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",
m);t[m?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",h);t[h?"remove":"add"](this._mediaCaption,"hidden");t[m&&h?"remove":"add"](f,"hidden");this._rid=null;if("image"===a.type)this._showImage(a);else{var l=this,m=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],h=a.value.theme||this.chartTheme;w.isString(h)&&(h=h.replace(/\./gi,"/"),-1===h.indexOf("/")&&(h="dojox/charting/themes/"+h));h||(h="./Rainbow");m.push(h);try{var c=this._rid=d++;k(m,function(h,
b,m){c===l._rid&&(l._rid=null,l._showChart(a.type,a.value,h,b,m))})}catch(N){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=a&&w.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(a){t.add(this._mediaFrame,"image");var m=v.get(this._gallery,"height"),h=a.value,d;h.linkURL&&(d=D.create("a",{href:h.linkURL,target:this._preventNewTab(h.linkURL)?"":"_blank"},this._mediaFrame));h=a.refreshInterval?this._addURLParameter(h.sourceURL,
"timestamp",Date.now()):h.sourceURL;D.create("img",{className:"esriPopupMediaImage",src:h},d||this._mediaFrame);var f=b.query(".esriPopupMediaImage",this._mediaFrame)[0];this._imageLoadHandle=q.connect(f,"onload",this,function(){this._clearImageHandles();this._imageLoaded(f,m);this._initImageRefresh(a)})},_addURLParameter:function(a,b,h){var m=-1===a.indexOf("?")?"?":"\x26";return a+m+b+"\x3d"+h},_initImageRefresh:function(a){if(a.refreshInterval){var b=6E4*a.refreshInterval;this._imageRefreshHandle=
setTimeout(w.hitch(this,function(){this._destroyFrame();this._showImage(a)}),b)}},_clearImageHandles:function(){q.disconnect(this._imageLoadHandle);this._imageLoadHandle=null;clearTimeout(this._imageRefreshHandle);this._imageRefreshHandle=null},_showChart:function(a,b,h,d,f){t.remove(this._mediaFrame,"image");h=this._chart=new h(D.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});f&&h.setTheme(f);switch(a){case "piechart":h.addPlot("default",{type:"Pie",labels:!1});h.addSeries("Series A",
b.fields);break;case "linechart":h.addPlot("default",{type:"Markers"});h.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});h.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});c.forEach(b.fields,function(a,b){a.x=b+1});h.addSeries("Series A",b.fields);break;case "columnchart":h.addPlot("default",{type:"Columns",gap:3});h.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});h.addSeries("Series A",b.fields);break;case "barchart":h.addPlot("default",{type:"Bars",
gap:3}),h.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),h.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),h.addSeries("Series A",b.fields)}this._action=new d(h);h.render()},_destroyFrame:function(){this._rid=null;this._clearImageHandles();this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var h=a.height;h<b&&v.set(a,"marginTop",
Math.round((b-h)/2)+"px")},_attListHandler:function(a,b){if(a===this._attachmentsDfd){this._attachmentsDfd=null;var h="";b instanceof Error||!b||!b.length||c.forEach(b,function(a){h+="\x3cli\x3e";h+="\x3ca href\x3d'"+f.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||"[No name]")+"\x3c/a\x3e";h+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",h||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_supportedURIInfos:[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:l.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,
label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,
appName:"Survey123",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:l.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:l.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:l.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:l.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:l.NLS_openLinkInApp},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:l.NLS_openLinkInApp}],_findURIInfo:function(a){var b;c.some(this._supportedURIInfos,function(h){h.pattern.test(a)&&(b=h);return!!b});return b},_createLinkIfURI:function(b){var m=this._findURIInfo(b);if(m){var h=b.match(m.pattern);return b.replace(m.pattern,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+a.substitute({appName:m.appName,hierPart:h&&h[2]},m.label)+"\x3c/a\x3e")}return b},_showStatus:function(a){e.set(this._status,
"innerHTML",a);t.remove(this._status,"hidden");b.query(".mainSection",this.domNode).addClass("hidden")},_hideStatus:function(){e.set(this._status,"innerHTML","");t.add(this._status,"hidden");b.query(".mainSection",this.domNode).removeClass("hidden")},_handleComponentsSuccess:function(a){if(a){this._hideStatus();var m=this.showTitle?a.title:"",h=a.description,d=a.fields,f=a.mediaInfos,r=this.domNode,g=this._nls,x=this,p=this.template,v=this.graphic;this._prevMedia.title=g.NLS_prevMedia;this._nextMedia.title=
g.NLS_nextMedia;e.set(this._title,"innerHTML",m);m||t.add(this._title,"hidden");!a.hasDescription&&d&&(h="",c.forEach(d,function(a){h+="\x3ctr valign\x3d'top'\x3e";h+="\x3ctd class\x3d'attrName'\x3e"+A.encode(a[0])+"\x3c/td\x3e";h+="\x3ctd class\x3d'attrValue'\x3e"+this._createLinkIfURI(a[1])+"\x3c/td\x3e";h+="\x3c/tr\x3e"},this),h&&(h="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+h+"\x3c/table\x3e"));e.set(this._description,"innerHTML",h);h||t.add(this._description,
"hidden");b.query("a",this._description).forEach(function(a){x._preventNewTab(a.href)?"_blank"===a.target&&e.remove(a,"target"):e.set(a,"target","_blank")});m&&h?b.query(".mainSection .hzLine",r).removeClass("hidden"):m||h?b.query(".mainSection .hzLine",r).addClass("hidden"):b.query(".mainSection",r).addClass("hidden");if(m=this._attachmentsDfd=p.getAttachments(v))m.addBoth(w.hitch(this,this._attListHandler,m)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+g.NLS_searching+"...\x3c/li\x3e"),
b.query(".attachmentsSection",r).removeClass("hidden");f&&f.length&&(b.query(".mediaSection",r).removeClass("hidden"),n.setSelectable(this._mediaFrame,!1),this._mediaInfos=f,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(e.set(this._editSummary,"innerHTML",a.editSummary),f&&f.length&&t.remove(this._mediaBreak,"hidden"),t.remove(this._editSummarySection,"hidden"));this.emit("content-update")}else this._showStatus(l.NLS_noInfo)},_handleComponentsError:function(a){a&&"cancel"===
a.dojoType||(console.log("PopupRenderer: error loading template",a),this._showStatus(l.NLS_noInfo))}});u("extend-esri")&&w.setObject("dijit._PopupRenderer",g,F);return g})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(k,g,q,w,c,b,u,p,n,e,t,D,v){function A(){}function B(b){return function(e,
a,f,c){return e&&"string"==typeof a&&e[a]==A?e.on(a.substring(2).toLowerCase(),u.hitch(f,c)):b.apply(q,arguments)}}k.around(q,"connect",B);b.connect&&k.around(b,"connect",B);k=w("dijit._Widget",[t,D,v],{onClick:A,onDblClick:A,onKeyDown:A,onKeyPress:A,onKeyUp:A,onMouseDown:A,onMouseMove:A,onMouseOut:A,onMouseOver:A,onMouseLeave:A,onMouseEnter:A,onMouseUp:A,constructor:function(b){this._toConnect={};for(var e in b)this[e]===A&&(this._toConnect[e.replace(/^on/,"").toLowerCase()]=b[e],delete b[e])},postCreate:function(){this.inherited(arguments);
for(var b in this._toConnect)this.on(b,this._toConnect[b]);delete this._toConnect},on:function(b,e){return this[this._onMap(b)]===A?q.connect(this.domNode,b.toLowerCase(),this,e):this.inherited(arguments)},_setFocusedAttr:function(b){this._focused=b;this._set("focused",b)},setAttribute:function(e,c){b.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(e,c)},attr:function(b,e){return 2<=arguments.length||"object"===typeof b?this.set.apply(this,
arguments):this.get(b)},getDescendants:function(){b.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?p("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});c("dijit-legacy-requires")&&n(0,function(){require(["dijit/_base"])});return k})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(k,g,q,w,c,b,u,p,n,e,t,D,v,A,B,C,F,a,f,r,z,d,l){function y(a){return function(b){p[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}v.add("dijit-legacy-requires",!A.isAsync);v.add("dojo-bidi",!1);v("dijit-legacy-requires")&&F(0,function(){k(["dijit/_base/manager"])});var x={};w=b("dijit._WidgetBase",[a,z],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:y("lang"),dir:"",_setDirAttr:y("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:w.blankGif||k.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,d=a._setterAttrs=[],a=a._onMap={},f;for(f in b.attributeMap)d.push(f);for(f in b)/^on/.test(f)&&(a[f.substring(2).toLowerCase()]=f),/^_set[A-Z](.*)Attr$/.test(f)&&(f=f.charAt(4).toLowerCase()+
f.substr(5,f.length-9),b.attributeMap&&f in b.attributeMap||d.push(f))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=u.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,B.mixin(this,a));this.postMixInProperties();this.id||(this.id=l.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=r.body(this.ownerDocument);l.add(this);this.buildRendering();var h;this.domNode&&(this._applyAttributes(),(a=this.srcNodeRef)&&a.parentNode&&this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),h=!0),this.domNode.setAttribute("widgetId",this.id));this.postCreate();h&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);g.forEach(this.constructor._setterAttrs,
function(b){if(!(b in a)){var h=this._get(b);h&&this.set(b,h)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(g.map(a,function(a){return a+"Rtl"})));n.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,g.forEach(this.getChildren(),function(a){a._started||
a._destroyed||!B.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();g.forEach(this._connects,B.hitch(this,"disconnect"));g.forEach(this._supportingWidgets,b);this.domNode&&g.forEach(l.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);
l.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?p.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){g.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=this.domNode;B.isObject(a)?
D.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,b,d){d=3<=arguments.length?d:this.attributeMap[a];g.forEach(B.isArray(d)?d:[d],function(d){var h=this[d.node||d||"domNode"];switch(d.type||"attribute"){case "attribute":B.isFunction(b)&&(b=B.hitch(this,b));d=d.attribute?d.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;h.tagName?p.set(h,d,b):h.set(d,b);break;case "innerText":h.innerHTML="";h.appendChild(this.ownerDocument.createTextNode(b));
break;case "innerHTML":h.innerHTML=b;break;case "class":n.replace(h,b,this[a]);break;case "toggleClass":n.toggle(h,d.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var d in a)this.set(d,a[d]);return this}d=this._getAttrNames(a);var h=this[d.s];if(B.isFunction(h))var f=h.apply(this,Array.prototype.slice.call(arguments,1));else{var h=this.focusNode&&!B.isFunction(this.focusNode)?"focusNode":
"domNode",e=this[h]&&this[h].tagName,m;if((m=e)&&!(m=x[e])){m=this[h];var l={},c;for(c in m)l[c.toLowerCase()]=!0;m=x[e]=l}c=m;d=a in this.attributeMap?this.attributeMap[a]:d.s in this?this[d.s]:c&&d.l in c&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?h:null;null!=d&&this._attrToDom(a,b,d);this._set(a,b)}return f||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var d=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return b[a]={n:a+"Node",s:"_set"+d+"Attr",g:"_get"+d+"Attr",l:d.toLowerCase()}},_set:function(a,b){var d=this[a];this[a]=b;!this._created||d===b||d!==d&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,d,b),this.emit("attrmodified-"+a,{detail:{prevValue:d,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,d){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var h,f=this["on"+a];f&&(h=f.apply(this,d?
d:[b]));this._started&&!this._beingDestroyed&&C.emit(this.domNode,a.toLowerCase(),b);return h},on:function(a,b){var d=this._onMap(a);return d?q.after(this,d,b,!0):this.own(C(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,d=b._onMap;if(!d){var d=b._onMap={},f;for(f in b.prototype)/^on/.test(f)&&(d[f.replace(/^on/,"").toLowerCase()]=f)}return d["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
l.findWidgets(this.containerNode):[]},getParent:function(){return l.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,d){return this.own(c.connect(a,b,this,d))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(f.subscribe(a,B.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():t.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=D.get(this.domNode,"display")},
placeAt:function(a,b){var d=!a.tagName&&l.byId(a);!d||!d.addChild||b&&"number"!==typeof b?(a=d&&"domNode"in d?d.containerNode&&!/after|before|replace/.test(b||"")?d.containerNode:d.domNode:u.byId(a,this.ownerDocument),e.place(this.domNode,a,b),!this._started&&(this.getParent()||{})._started&&this.startup()):d.addChild(this,b);return this},defer:function(a,b){var d=setTimeout(B.hitch(this,function(){d&&(d=null,this._destroyed||B.hitch(this,a)())}),b||0);return{remove:function(){d&&(clearTimeout(d),
d=null);return null}}}});v("dojo-bidi")&&w.extend(d);return w})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(k,g,q){return q("dijit.Destroyable",null,{destroy:function(g){this._destroyed=!0},own:function(){var q=["destroyRecursive","destroy","remove"];k.forEach(arguments,function(c){function b(){p.remove();k.forEach(n,function(b){b.remove()})}var w,p=g.before(this,"destroy",function(b){c[w](b)}),n=[];c.then?(w="cancel",c.then(b,b)):k.forEach(q,
function(e){"function"===typeof c[e]&&(w||(w=e),n.push(g.after(c,e,b,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(k,g,q,w,c,b){k=w("dijit._OnDijitClickMixin",null,{connect:function(c,g,n){return this.inherited(arguments,[c,"ondijitclick"==g?b:g,n])}});k.a11yclick=b;return k})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(k,g,q,w){w.extend(g,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return q("dijit._FocusMixin",null,{_focusManager:k})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(k,g,q,w){q(function(){g("highcontrast")&&k.add(w.body(),"dijit_a11y")});return g})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(k,g,q,w,c,b,u){c.add("highcontrast",function(){var b=u.doc.createElement("div");try{b.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(g.blankGif||k.toUrl("./resources/blank.gif"))+'");';u.body().appendChild(b);var n=w.getComputedStyle(b),e=n.backgroundImage;return n.borderTopColor==n.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(t){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
t.toString()),!1}finally{8>=c("ie")?b.outerHTML="":u.body().removeChild(b)}});b(function(){c("highcontrast")&&q.add(u.body(),"dj_a11y")});return c})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(k,g,q,w,c,b,u){b.extend(k,{waiRole:"",waiState:""});return c("dijit._Templated",[g,q],{constructor:function(){u.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(b,c){var e=this.inherited(arguments),g=c(b,"waiRole");g&&b.setAttribute("role",g);(g=c(b,"waiState"))&&w.forEach(g.split(/\s*,\s*/),function(e){-1!=e.indexOf("-")&&(e=e.split("-"),b.setAttribute("aria-"+e[0],e[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(k,g,q,w,c,b,u,p){var n=g("dijit._TemplatedMixin",p,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(b){var e=this.declaredClass,c=this;return u.substitute(b,this,function(b,g){"!"==g.charAt(0)&&(b=w.getObject(g.substr(1),!1,c));if("undefined"==typeof b)throw Error(e+" template:"+g);return null==b?"":"!"==g.charAt(0)?b:this._escapeValue(""+b)},this)},_escapeValue:function(b){return b.replace(/["'<>&]/g,function(b){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[b]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=k(this.templatePath,{sanitize:!0}));var b=n.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(w.isString(b)){if(c=q.toDom(this._stringRepl(b),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+b);}else c=b.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(b){var e=this.containerNode;if(b&&e)for(;b.hasChildNodes();)e.appendChild(b.firstChild)}});
n._templateCache={};n.getCachedTemplate=function(b,c,g){var e=n._templateCache,p=b,k=e[p];if(k){try{if(!k.ownerDocument||k.ownerDocument==(g||document))return k}catch(C){}q.destroy(k)}b=u.trim(b);if(c||b.match(/\$\{([^\}]+)\}/g))return e[p]=b;c=q.toDom(b,g);if(1!=c.nodeType)throw Error("Invalid template: "+b);return e[p]=c};b("ie")&&c(window,"unload",function(){var b=n._templateCache,c;for(c in b){var g=b[c];"object"==typeof g&&q.destroy(g);delete b[c]}});return n})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(k){return k.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(k,g,q,w,c,b,u,p,n){var e=c.delegate(p,{mouseenter:b.enter,mouseleave:b.leave,keypress:q._keypress}),t;q=w("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(b){for(var c=b;;)if(1==c.nodeType&&(this._processTemplateNode(c,function(b,c){return b.getAttribute(c)},this._attach)||this.searchContainerNode)&&c.firstChild)c=c.firstChild;else{if(c==b)break;for(;!c.nextSibling;)if(c=c.parentNode,c==b)return;c=c.nextSibling}},_processTemplateNode:function(b,e,g){var p=!0,k=this.attachScope||this,n=e(b,"dojoAttachPoint")||e(b,"data-dojo-attach-point");if(n)for(var a=n.split(/\s*,\s*/);n=
a.shift();)c.isArray(k[n])?k[n].push(b):k[n]=b,p="containerNode"!=n,this._attachPoints.push(n);if(e=e(b,"dojoAttachEvent")||e(b,"data-dojo-attach-event"))for(n=e.split(/\s*,\s*/),a=c.trim;e=n.shift();)if(e){var f=null;-1!=e.indexOf(":")?(f=e.split(":"),e=a(f[0]),f=a(f[1])):e=a(e);f||(f=e);this._attachEvents.push(g(b,e,c.hitch(k,f)))}return p},_attach:function(b,c,g){c=c.replace(/^on/,"").toLowerCase();c="dijitclick"==c?t||(t=k("./a11yclick")):e[c]||c;return u(b,c,g)},_detachTemplateNodes:function(){var b=
this.attachScope||this;g.forEach(this._attachPoints,function(c){delete b[c]});this._attachPoints=[];g.forEach(this._attachEvents,function(b){b.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});c.extend(n,{dojoAttachEvent:"",dojoAttachPoint:""});return q})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(k,g,q,w,c){return q("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var b=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);c.parse(b,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(w.hitch(this,function(b){this._startupWidgets=b;for(var c=0;c<b.length;c++)this._processTemplateNode(b[c],
function(b,c){return b[c]},function(b,c,g){return c in b?b.connect(b,c,g):b.on(c,g,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(b,c,g){return c(b,"dojoType")||c(b,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){k.forEach(this._startupWidgets,function(b){b&&!b._started&&b.startup&&b.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(k,g,q,w,c,b,u,p,n,e,t,D,v,A,B,C){function F(a){return eval("("+a+")")}function a(a){var b=
a._nameCaseMap,d=a.prototype;if(!b||b._extendCnt<r){var b=a._nameCaseMap={},f;for(f in d)"_"!==f.charAt(0)&&(b[f.toLowerCase()]=f);b._extendCnt=r}return b}function f(a,b){b||(b=k);var d=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),f=a.join();if(!d[f]){for(var c=[],h=0,e=a.length;h<e;h++){var l=a[h];c[c.length]=d[l]=d[l]||q.getObject(l)||~l.indexOf("/")&&b(l)}a=c.shift();d[f]=c.length?a.createSubclass?a.createSubclass(c):a.extend.apply(a,c):a}return d[f]}new Date("X");var r=0;n.after(q,"extend",
function(){r++},!0);var z={_clearCache:function(){r++;_ctorMap={}},_functionFromScript:function(a,b){var d="",f="",c=a.getAttribute(b+"args")||a.getAttribute("args");b=a.getAttribute("with");c=(c||"").split(/\s*,\s*/);b&&b.length&&w.forEach(b.split(/\s*,\s*/),function(a){d+="with("+a+"){";f+="}"});return new Function(c,d+a.innerHTML+f)},instantiate:function(a,b,f){b=b||{};f=f||{};var d=(f.scope||g._scopeName)+"Type",c="data-"+(f.scope||g._scopeName)+"-",h=c+"type",e=c+"mixins",l=[];w.forEach(a,function(a){var f=
d in b?b[d]:a.getAttribute(h)||a.getAttribute(d);if(f){var c=a.getAttribute(e),f=c?[f].concat(c.split(/\s*,\s*/)):[f];l.push({node:a,types:f})}});return this._instantiate(l,b,f)},_instantiate:function(a,b,c,g){function d(a){b._started||c.noStart||w.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=w.map(a,function(a){var d=a.ctor||f(a.types,c.contextRequire);if(!d)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(d,
a.node,b,c,a.scripts,a.inherited)},this);return g?e(a).then(d):d(a)},construct:function(b,f,c,e,m,h){function d(a){D&&q.setObject(D,a);for(y=0;y<I.length;y++)n[I[y].advice||"after"](a,I[y].method,q.hitch(a,I[y].func),!0);for(y=0;y<L.length;y++)L[y].call(a);for(y=0;y<K.length;y++)a.watch(K[y].prop,K[y].func);for(y=0;y<J.length;y++)B(a,J[y].event,J[y].func);return a}var l=b&&b.prototype;e=e||{};var r={};e.defaults&&q.mixin(r,e.defaults);h&&q.mixin(r,h);var x;v("dom-attributes-explicit")?x=f.attributes:
v("dom-attributes-specified-flag")?x=w.filter(f.attributes,function(a){return a.specified}):(h=(/^input$|^img$/i.test(f.nodeName)?f:f.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),x=w.map(h.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==f.nodeName&&"value"==a||"enctype"==b?f.getAttribute(b):f.getAttributeNode(b).value}}));var z=e.scope||g._scopeName;h="data-"+z+"-";var k={};"dojo"!==z&&(k[h+"props"]=
"data-dojo-props",k[h+"type"]="data-dojo-type",k[h+"mixins"]="data-dojo-mixins",k[z+"type"]="dojotype",k[h+"id"]="data-dojo-id");for(var y=0,u,z=[],D,H;u=x[y++];){var G=u.name,C=G.toLowerCase();u=u.value;switch(k[C]||C){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":H=u;break;case "data-dojo-id":case "jsid":D=u;break;case "data-dojo-attach-point":case "dojoattachpoint":r.dojoAttachPoint=u;break;case "data-dojo-attach-event":case "dojoattachevent":r.dojoAttachEvent=
u;break;case "class":r["class"]=f.className;break;case "style":r.style=f.style&&f.style.cssText;break;default:if(G in l||(G=a(b)[C]||G),G in l)switch(typeof l[G]){case "string":r[G]=u;break;case "number":r[G]=u.length?Number(u):NaN;break;case "boolean":r[G]="false"!=u.toLowerCase();break;case "function":""===u||-1!=u.search(/[^\w\.]+/i)?r[G]=new Function(u):r[G]=q.getObject(u,!1)||new Function(u);z.push(G);break;default:C=l[G],r[G]=C&&"length"in C?u?u.split(/\s*,\s*/):[]:C instanceof Date?""==u?new Date(""):
"now"==u?new Date:t.fromISOString(u):C instanceof p?g.baseUrl+u:F(u)}else r[G]=u}}for(x=0;x<z.length;x++)k=z[x].toLowerCase(),f.removeAttribute(k),f[k]=null;if(H)try{H=F.call(e.propsThis,"{"+H+"}"),q.mixin(r,H)}catch(M){throw Error(M.toString()+" in data-dojo-props\x3d'"+H+"'");}q.mixin(r,c);m||(m=b&&(b._noScript||l._noScript)?[]:A("\x3e script[type^\x3d'dojo/']",f));var I=[],L=[],K=[],J=[];if(m)for(y=0;y<m.length;y++)k=m[y],f.removeChild(k),c=k.getAttribute(h+"event")||k.getAttribute("event"),e=
k.getAttribute(h+"prop"),H=k.getAttribute(h+"method"),z=k.getAttribute(h+"advice"),x=k.getAttribute("type"),k=this._functionFromScript(k,h),c?"dojo/connect"==x?I.push({method:c,func:k}):"dojo/on"==x?J.push({event:c,func:k}):r[c]=k:"dojo/aspect"==x?I.push({method:H,advice:z,func:k}):"dojo/watch"==x?K.push({prop:e,func:k}):L.push(k);b=(m=b.markupFactory||l.markupFactory)?m(r,f,b):new b(r,f);return b.then?b.then(d):d(b)},scan:function(a,b){function d(a){if(!a.inherited){a.inherited={};var b=a.node,f=
d(a.parent),b={dir:b.getAttribute("dir")||f.dir,lang:b.getAttribute("lang")||f.lang,textDir:b.getAttribute(z)||f.textDir},c;for(c in b)b[c]&&(a.inherited[c]=b[c])}return a.inherited}var c=[],e=[],h={},l=(b.scope||g._scopeName)+"Type",r="data-"+(b.scope||g._scopeName)+"-",p=r+"type",z=r+"textdir",r=r+"mixins",n=a.firstChild,q=b.inherited;if(!q){var t=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&t(a.parentNode,b)},q={dir:t(a,"dir"),lang:t(a,"lang"),textDir:t(a,z)},u;for(u in q)q[u]||
delete q[u]}u={inherited:q};for(var A,B;;)if(n)if(1!=n.nodeType)n=n.nextSibling;else if(A&&"script"==n.nodeName.toLowerCase())(q=n.getAttribute("type"))&&/^dojo\/\w/i.test(q)&&A.push(n),n=n.nextSibling;else if(B)n=n.nextSibling;else if(q=n.getAttribute(p)||n.getAttribute(l),a=n.firstChild,q||a&&(3!=a.nodeType||a.nextSibling)){B=null;if(q){var C=n.getAttribute(r);A=C?[q].concat(C.split(/\s*,\s*/)):[q];try{B=f(A,b.contextRequire)}catch(I){}B||w.forEach(A,function(a){~a.indexOf("/")&&!h[a]&&(h[a]=!0,
e[e.length]=a)});C=B&&!B.prototype._noScript?[]:null;u={types:A,ctor:B,parent:u,node:n,scripts:C};u.inherited=d(u);c.push(u)}else u={node:n,scripts:A,parent:u};A=C;B=n.stopParser||B&&B.prototype.stopParser&&!b.template;n=a}else n=n.nextSibling;else{if(!u||!u.node)break;n=u.node.nextSibling;B=!1;u=u.parent;A=u.scripts}var F=new D;e.length?(v("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+e.join(", ")),(b.contextRequire||k)(e,function(){F.resolve(w.filter(c,function(a){if(!a.ctor)try{a.ctor=
f(a.types,b.contextRequire)}catch(J){}for(var d=a.parent;d&&!d.types;)d=d.parent;var c=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(c&&c.stopParser&&!b.template);a.instantiate=!d||d.instantiate&&d.instantiateChildren;return a.instantiate}))})):F.resolve(c);return F.promise},_require:function(a,b){a=F("{"+a.innerHTML+"}");var d=[],f=[],c=new D;b=b&&b.contextRequire||k;for(var h in a)d.push(h),f.push(a[h]);b(f,function(){for(var a=0;a<d.length;a++)q.setObject(d[a],arguments[a]);c.resolve(arguments)});
return c.promise},_scanAmd:function(a,b){var d=new D,f=d.promise;d.resolve(!0);var c=this;A("script[type\x3d'dojo/require']",a).forEach(function(a){f=f.then(function(){return c._require(a,b)});a.parentNode.removeChild(a)});return f},parse:function(a,f){!a||"string"==typeof a||"nodeType"in a||(f=a,a=f.rootNode);var d=a?b.byId(a):u.body();f=f||{};var c=f.template?{template:!0}:{},e=[],h=this;a=this._scanAmd(d,f).then(function(){return h.scan(d,f)}).then(function(a){return h._instantiate(a,c,f,!0)}).then(function(a){return e=
e.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});q.mixin(e,a);return e}};g.parser=z;c.parseOnLoad&&C(100,z,"parse");return z})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(k,g){var q={};k.setObject("dojo.date.stamp",q);q.fromISOString=function(k,c){q._isoRegExp||(q._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var b=q._isoRegExp.exec(k);k=null;
if(b){b.shift();b[1]&&b[1]--;b[6]&&(b[6]*=1E3);c&&(c=new Date(c),g.forEach(g.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(b){return c["get"+b]()}),function(c,e){b[e]=b[e]||c}));k=new Date(b[0]||1970,b[1]||0,b[2]||1,b[3]||0,b[4]||0,b[5]||0,b[6]||0);100>b[0]&&k.setFullYear(b[0]||1970);var u=0,p=b[7]&&b[7].charAt(0);"Z"!=p&&(u=60*(b[8]||0)+(Number(b[9])||0),"-"!=p&&(u*=-1));p&&(u-=k.getTimezoneOffset());u&&k.setTime(k.getTime()+6E4*u)}return k};q.toISOString=function(g,
c){var b=function(b){return 10>b?"0"+b:b};c=c||{};var k=[],p=c.zulu?"getUTC":"get",n="";"time"!=c.selector&&(n=g[p+"FullYear"](),n=["0000".substr((n+"").length)+n,b(g[p+"Month"]()+1),b(g[p+"Date"]())].join("-"));k.push(n);"date"!=c.selector&&(n=[b(g[p+"Hours"]()),b(g[p+"Minutes"]()),b(g[p+"Seconds"]())].join(":"),p=g[p+"Milliseconds"](),c.milliseconds&&(n+="."+(100>p?"0":"")+b(p)),c.zulu?n+="Z":"time"!=c.selector&&(g=g.getTimezoneOffset(),c=Math.abs(g),n+=(0<g?"-":"+")+b(Math.floor(c/60))+":"+b(c%
60)),k.push(n));return k.join("T")};return q})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(k,g,q,w,c,b){return k([b,c],{_onMap:function(b){var c=this.constructor._onMap,g;c&&c.FINAL||(delete this.constructor._onMap,c=this.registerConnectEvents(),c.FINAL=!0);b=b.toLowerCase();c[b]?g=this[c[b].method]:(b=this._onCamelCase(b),this[b]&&(g=b));return g},on:function(b,c){var g=this._onMap(b),e=b.replace(/\-/g,
""),k="on"+e in this.domNode;return g||!k?this.inherited(arguments):this.own(w(this.domNode,e,c))[0]},emit:function(b,c,k){var e,p,n,q=b.toLowerCase(),u=this.constructor._onMap||this.registerConnectEvents();p=this[this._onMap(q)];c=c||{};c.target||(c.target=this);p&&u&&u[q]&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},u[q].argKeys)(c),n=g.mixin({},arguments),n[2]=e,n[0]=u[q].name.replace(/^on/,""));return this.inherited(n||arguments)}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(k,g,q,w,c){k=k(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(b){b&&(this.name=b.name,this.title=b.title,this.description=b.description,this.extent=b.extent,this.legendURL=b.legendURL,this.subLayers=b.subLayers?b.subLayers:[],this.allExtents=b.allExtents?b.allExtents:[],
this.spatialReferences=b.spatialReferences?b.spatialReferences:[],this.queryable=!!b.queryable,this.showPopup=!!b.showPopup)},clone:function(){var b={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},c;this.extent&&(b.extent=this.extent.getExtent());b.subLayers=[];q.forEach(this.subLayers,function(c){b.subLayers.push(c.clone())});b.allExtents=[];for(c in this.allExtents)c=parseInt(c,10),isNaN(c)||(b.allExtents[c]=this.allExtents[c].getExtent());b.spatialReferences=
[];q.forEach(this.spatialReferences,function(c){b.spatialReferences.push(c)});b.queryable=this.queryable;b.showPopup=this.showPopup;return b}});w("extend-esri")&&g.setObject("layers.WMSLayerInfo",k,c);return k})},"*noref":1}});
define("esri/layers/WMSLayer","require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(k,g,q,w,c,b,u,p,n,e,t,D,v,A,B,C,F){q=q([C],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,
2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,
27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,b){var c=t.urlToObject(a);c.query&&(c.query.version||c.query.Version||c.query.VERSION)&&(this.version=c.query.version||c.query.Version||c.query.VERSION);this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
this._url=t.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=w.hitch(this,this._initLayer);this._parseCapabilities=w.hitch(this,this._parseCapabilities);this._getCapabilitiesError=w.hitch(this,this._getCapabilitiesError);b?(this.customParameters=b.customParameters,this.customLayerParameters=b.customLayerParameters,this.imageFormat=this._getImageFormat(b.format),this.imageTransparency=!1!==b.transparent,this.visibleLayers=b.visibleLayers?b.visibleLayers:[],this.version=b.version||this.version,
b.resourceInfo?this._readResourceInfo(b.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=k.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);this._createChildLayer()},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},
setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},setCustomParameters:function(a,b){this.customParameters=a;this.customLayerParameters=b;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,arguments)},getImageUrl:function(a,b,c,e){if(this.visibleLayers&&0!==this.visibleLayers.length){a=this._getImageParams(a,b,c);a=this._mixinCustomLayerParameters(a);b=this.getMapURL;var d;b+=-1===b.indexOf("?")?
"?":"";for(d in a)a.hasOwnProperty(d)&&(b+="?"===b.substring(b.length-1,b.length)?"":"\x26",b+=d+"\x3d"+a[d]);e(t.addProxy(b))}else e(this._blankImageURL)},_setMap:function(a,b,c){var f=this.inherited(arguments);a.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(a,f)):this._childLayer=this.extentProcessor=null;return f},_unsetMap:function(a,b){this._childLayer&&this._childLayer._unsetMap(a,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);
this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new C(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=w.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(a){return w.hitch(this,this._extentProcessor,a)},_extentProcessor:function(a,b){var c=b.extent,f=b.width,
d=0;if(c){b=c.getWidth()/f;var e=c.bisect(),c=e.extents,g=c[a];g&&(f=e.marginLeft/b,d=0===a?f:f+c[0].getWidth()/b,f=Math.ceil(g.getWidth()/b),d=Math.ceil(d));c=g}return{extent:c,width:f,marginLeft:d}},_getImageParams:function(a,b,e){var f=a.spatialReference.wkid;-1===c.indexOf(this.spatialReferences,f)&&a.spatialReference.latestWkid&&(f=a.spatialReference.latestWkid);if(c.some(this._WEB_MERCATOR,function(a){return a==f})){var d=c.filter(this.spatialReferences,function(a){return c.some(this._WEB_MERCATOR,
function(b){return b==a})},this);0===d.length&&(d=c.filter(this.spatialReferences,function(a){return c.some(this._WORLD_MERCATOR,function(b){return b==a})},this));f=0<d.length?d[0]:this._WEB_MERCATOR[1]}this.spatialReferences=c.filter(this.spatialReferences,function(a){return a!==f});this.spatialReferences.unshift(f);var d=a.xmin,g=a.xmax,r=a.ymin;a=a.ymax;var k={SERVICE:"WMS",REQUEST:"GetMap"};k.FORMAT=this.imageFormat;k.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";k.STYLES="";k.VERSION=this.version;
k.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;k.WIDTH=b;k.HEIGHT=e;this.maxWidth<b&&(k.WIDTH=this.maxWidth);this.maxHeight<e&&(k.HEIGHT=this.maxHeight);b=f?f:NaN;isNaN(b)||("1.3.0"==this.version?k.CRS="EPSG:"+b:k.SRS="EPSG:"+b);"1.3.0"==this.version&&this._useLatLong(b)?k.BBOX=r+","+d+","+a+","+g:k.BBOX=d+","+r+","+g+","+a;return k},_initLayer:function(a,c){this.spatialReference=new v(this.extent.spatialReference);this.initialExtent=new A(this.extent);this.fullExtent=new A(this.extent);
this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var f=w.hitch(this,function(){this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))});b("chrome")?(a=u.defaults.io,c="with-credentials"===a.useCors?t.canUseXhr(this.getMapURL,!0):-1,(a=-1<c?a.corsEnabledServers[c]:null)&&a.withCredentials?e({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){f()}):f()):f()},_readResourceInfo:function(a){a.extent?
a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=a.getFeatureInfoURL,this.featureInfoFormat=a.featureInfoFormat,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=
a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this.customLayerParameters=a.customLayerParameters||this.customLayerParameters,this.customParameters=a.customParameters||this.customParameters,this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},
_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var a=this._mixinCustomParameters(a),b=this._url.path+"?",c;for(c in a)a.hasOwnProperty(c)&&(b+="?"==b.substring(b.length-1,b.length)?"":"\x26",b+=c+"\x3d"+a[c]);e({url:b,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(a){var b=this;this.version=
this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var e=this._getTag("Service",a);this.title=this._getTagValue("Title",e,"");this.title||(this.title=this._getTagValue("Name",e,""));this.copyright=this._getTagValue("AccessConstraints",e,"");this.description=this._getTagValue("Abstract",e,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",e,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",
e,5E3),10);if(e=this._getTag("Layer",a)){var k=this._getLayerInfo(e),d=0,l=null,e=this._getTag("Capability",a);c.forEach(e.childNodes,function(a){"Layer"==a.nodeName&&(0===d?l=a:(1===d&&k.name&&(k.name="",k.subLayers=[],k.subLayers.push(this._getLayerInfo(l))),k.subLayers.push(this._getLayerInfo(a))),d++)},this);if(k&&(this.layerInfos=k.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[k]),this.extent=k.extent,this.extent||(k.extent=new A(this.layerInfos[0].extent.toJson()),
this.extent=k.extent),this.allExtents=k.allExtents,this.allExtents&&this.allExtents.length||(k.allExtents=[],c.forEach(this.layerInfos[0].allExtents,function(a,b){a&&(k.allExtents[b]=new A(a.toJson()))}),this.allExtents=k.allExtents),this.spatialReferences=k.spatialReferences,!this.spatialReferences.length&&0<this.layerInfos.length))for(var n=function(a){var b;for(b=0;b<a.subLayers.length;b++){var c=a.subLayers[b],d=c.spatialReferences;!d.length&&c.subLayers&&0<c.subLayers.length&&(d=n(c));if(d.length)return d}return[]},
e=0;e<this.layerInfos.length;e++){var p=this.layerInfos[e];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&p.subLayers&&0<p.subLayers.length&&(this.spatialReferences=n(p));if(this.spatialReferences.length)break}e=function(c){return(c=g.query("DCPType",b._getTag(c,a)))&&0<c.length&&(c=g.query("HTTP",c[0]))&&0<c.length&&(c=g.query("Get",c[0]))&&0<c.length&&(c=b._getAttributeValue("OnlineResource","xlink:href",c[0],null))?(c.indexOf("\x26")===c.length-1&&(c=
c.substring(0,c.length-1)),b._stripParameters(c,["service","request"])):null};p=function(d){var f=[];0===g.query("Operation",a).length?c.forEach(g.query("Format",b._getTag(d,a)),function(a){f.push(a.text?a.text:a.textContent)}):c.forEach(g.query("Operation",a),function(a){a.getAttribute("name")===d&&c.forEach(g.query("Format",a),function(a){f.push(a.text?a.text:a.textContent)})});return f};this.getMapURL=e("GetMap")||this._getCapabilitiesURL;this.getMapFormats=p("GetMap");c.some(this.getMapFormats,
function(a){return-1<a.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=e("GetFeatureInfo"))this.getFeatureInfoFormats=p("GetFeatureInfo"),-1<c.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<c.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var m=function(a){if(a&&(a.queryable=!1,a.subLayers))for(var b=0;b<a.subLayers.length;b++)m(a.subLayers[b])};
m(k)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(a){a&&a.message&&(a.message="GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+a.message+")");this._errorHandler(a)},_getLayerInfo:function(a){if(!a)return null;var b=new F;b.name="";b.title="";b.description="";b.allExtents=
[];b.spatialReferences=[];b.queryable="1"===a.getAttribute("queryable");b.subLayers=[];var e=this._getTag("LatLonBoundingBox",a);e&&(b.allExtents[0]=this._getExtent(e,4326));var g=this._getTag("EX_GeographicBoundingBox",a),d;g&&(d=new A(0,0,0,0,new v({wkid:4326})),d.xmin=parseFloat(this._getTagValue("westBoundLongitude",g,0)),d.ymin=parseFloat(this._getTagValue("southBoundLatitude",g,0)),d.xmax=parseFloat(this._getTagValue("eastBoundLongitude",g,0)),d.ymax=parseFloat(this._getTagValue("northBoundLatitude",
g,0)),b.allExtents[0]=d);e||g||(d=new A(-180,-90,180,90,new v({wkid:4326})),b.allExtents[0]=d);b.extent=b.allExtents[0];var k=-1<c.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";c.forEach(a.childNodes,function(a){if("Name"==a.nodeName)b.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)b.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)b.description=(a.text?a.text:a.textContent)||"";else if("BoundingBox"==a.nodeName){var d=a.getAttribute(k);d&&0===
d.indexOf("EPSG:")?(d=parseInt(d.substring(5),10),0===d||isNaN(d)||(a="1.3.0"==this.version?this._getExtent(a,d,this._useLatLong(d)):this._getExtent(a,d),b.allExtents[d]=a,b.extent||(b.extent=a))):d&&0===d.indexOf("CRS:")?(d=parseInt(d.substring(4),10),0===d||isNaN(d)||(this._CRS_TO_EPSG[d]&&(d=this._CRS_TO_EPSG[d]),b.allExtents[d]=this._getExtent(a,d))):(d=parseInt(d,10),0===d||isNaN(d)||(b.allExtents[d]=this._getExtent(a,d)))}else if(a.nodeName==k)a=(a.text?a.text:a.textContent).split(" "),c.forEach(a,
function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0===a||isNaN(a)||(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==c.indexOf(b.spatialReferences,a)&&b.spatialReferences.push(a))},this);else if("Style"!=a.nodeName||b.legendURL)"Layer"===a.nodeName&&b.subLayers.push(this._getLayerInfo(a));else if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))b.legendURL=a.getAttribute("xlink:href")},this);b.title=b.title||b.name;return b},_getImageFormat:function(a){switch(a?
a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,b,c){var e;if(a){e=new A;var d=parseFloat(a.getAttribute("minx")),f=parseFloat(a.getAttribute("miny")),
g=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));c?(e.xmin=isNaN(f)?-1*Number.MAX_VALUE:f,e.ymin=isNaN(d)?-1*Number.MAX_VALUE:d,e.xmax=isNaN(a)?Number.MAX_VALUE:a,e.ymax=isNaN(g)?Number.MAX_VALUE:g):(e.xmin=isNaN(d)?-1*Number.MAX_VALUE:d,e.ymin=isNaN(f)?-1*Number.MAX_VALUE:f,e.xmax=isNaN(g)?Number.MAX_VALUE:g,e.ymax=isNaN(a)?Number.MAX_VALUE:a);e.spatialReference=new v({wkid:b})}return e},_useLatLong:function(a){var b,c;for(c=0;c<this._REVERSED_LAT_LONG_RANGES.length;c++){var e=
this._REVERSED_LAT_LONG_RANGES[c];if(a>=e[0]&&a<=e[1]){b=!0;break}}return b},_getTag:function(a,b){return(a=g.query(a,b))&&0<a.length?a[0]:null},_getTagValue:function(a,b,c){return(a=g.query(a,b))&&0<a.length?a[0].text?a[0].text:a[0].textContent:c},_getAttributeValue:function(a,b,c,e){return(a=g.query(a,c))&&0<a.length?a[0].getAttribute(b):e},_checkVisibleLayersList:function(a){if(a&&0<a.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof a[0]){var b=[];c.forEach(a,function(a){a<this.layerInfos.length&&
b.push(this.layerInfos[a].name)},this);a=b}return a},_stripParameters:function(a,b){a=t.urlToObject(a);var e,f=[];for(e in a.query)a.query.hasOwnProperty(e)&&-1===c.indexOf(b,e.toLowerCase())&&f.push(e+"\x3d"+a.query[e]);return a.path+(f.length?"?"+f.join("\x26"):"")},_getPopupGraphic:function(a,b){var e=this.visibleLayers;if(!e||0===e.length)return null;var f=this._popupGraphic;f||(f=new D({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+
k.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),f=this._popupGraphic=new p(null,null,{},f),f._layer=this);var d=function(a){var b=[];if(a&&(a.queryable&&a.showPopup&&a.name&&b.push(a.name),a.subLayers))for(var c=0;c<a.subLayers.length;c++){var e=d(a.subLayers[c]);e.length&&(b=b.concat(e))}return b},g=d({subLayers:this.layerInfos}),g=c.filter(g,function(a){return-1<
c.indexOf(e,a)});if(g.length){var n=this.getFeatureInfoURL;a=this._getImageParams(a.extent,a.width,a.height);a=this._mixinCustomLayerParameters(a);a.REQUEST="GetFeatureInfo";a.INFO_FORMAT=this.featureInfoFormat;a.QUERY_LAYERS=g.join();a.FEATURE_COUNT=25;"1.3.0"===this.version?(a.I=Math.round(b.x),a.J=Math.round(b.y)):(a.X=Math.round(b.x),a.Y=Math.round(b.y));var n=n+(-1===n.indexOf("?")?"?":""),q;for(q in a)a.hasOwnProperty(q)&&(n+="?"===n.substring(n.length-1,n.length)?"":"\x26",n+=q+"\x3d"+a[q]);
f.attributes.QUERY_URL=n;return f}return null},_mixinCustomParameters:function(a){if(this.customParameters)for(var b in this.customParameters)a[b]=encodeURIComponent(this.customParameters[b]);return a},_mixinCustomLayerParameters:function(a){if(this.customLayerParameters||this.customParameters){var b=w.clone(this.customParameters||{});w.mixin(b,this.customLayerParameters||{});for(var c in b)"styles"===c.toLowerCase()&&delete a.STYLES,a[c]=encodeURIComponent(b[c])}return a}});b("extend-esri")&&w.setObject("layers.WMSLayer",
q,n);return q});